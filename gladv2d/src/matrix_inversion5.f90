
    !program m55inv_main
    !
    !implicit none
    !
    !integer :: i, j
    !double precision, dimension(5,5) :: mat, matinv
    !integer :: flag
    !
    !write (*,'(/a/)') ' enter matrix:'
    !
    !do i = 1,5
    !do j = 1,5
    !write (*,'(a,i1,1h,,i1,a)', advance='no') ' a(', i, j, ') = '
    !read (*,*) mat(i,j)
    !end do
    !end do
    !
    !call m55inv (mat,matinv,flag)
    !
    !if(flag .eq. 1)then
    !write (*,'(/a/)') ' inverse:'
    !write (*,'(5es25.15)') ((matinv(i,j), j=1,5), i=1,5)
    !elseif( flag .eq. 0 )then
    ! write (*,'(/a)') ' singular matrix.'
    !end if
    !
    !stop
    !
    !end program m55inv_main

    subroutine m55inv (a,ainv,flag)
    implicit none

    double precision, dimension(5,5), intent(in)  :: a
    double precision, dimension(5,5), intent(out) :: ainv
    integer, intent(out) :: flag

    double precision, parameter :: eps = 1.0d-10
    double precision :: det, a11, a12, a13, a14, a15, a21, a22, a23, a24, &
                 a25, a31, a32, a33, a34, a35, a41, a42, a43, a44, a45,   &
                 a51, a52, a53, a54, a55
    double precision, dimension(5,5) :: cofactor

    a11=a(1,1); a12=a(1,2); a13=a(1,3); a14=a(1,4); a15=a(1,5)
    a21=a(2,1); a22=a(2,2); a23=a(2,3); a24=a(2,4); a25=a(2,5)
    a31=a(3,1); a32=a(3,2); a33=a(3,3); a34=a(3,4); a35=a(3,5)
    a41=a(4,1); a42=a(4,2); a43=a(4,3); a44=a(4,4); a45=a(4,5)
    a51=a(5,1); a52=a(5,2); a53=a(5,3); a54=a(5,4); a55=a(5,5)

    det = a15*a24*a33*a42*a51-a14*a25*a33*a42*a51-a15*a23*a34*a42*a51+    &
        a13*a25*a34*a42*a51+a14*a23*a35*a42*a51-a13*a24*a35*a42*a51-       &
        a15*a24*a32*a43*a51+a14*a25*a32*a43*a51+a15*a22*a34*a43*a51-       &
        a12*a25*a34*a43*a51-a14*a22*a35*a43*a51+a12*a24*a35*a43*a51+       &
        a15*a23*a32*a44*a51-a13*a25*a32*a44*a51-a15*a22*a33*a44*a51+       &
        a12*a25*a33*a44*a51+a13*a22*a35*a44*a51-a12*a23*a35*a44*a51-       &
        a14*a23*a32*a45*a51+a13*a24*a32*a45*a51+a14*a22*a33*a45*a51-       &
        a12*a24*a33*a45*a51-a13*a22*a34*a45*a51+a12*a23*a34*a45*a51-       &
        a15*a24*a33*a41*a52+a14*a25*a33*a41*a52+a15*a23*a34*a41*a52-       &
        a13*a25*a34*a41*a52-a14*a23*a35*a41*a52+a13*a24*a35*a41*a52+       &
        a15*a24*a31*a43*a52-a14*a25*a31*a43*a52-a15*a21*a34*a43*a52+       &
        a11*a25*a34*a43*a52+a14*a21*a35*a43*a52-a11*a24*a35*a43*a52-       &
        a15*a23*a31*a44*a52+a13*a25*a31*a44*a52+a15*a21*a33*a44*a52-       &
        a11*a25*a33*a44*a52-a13*a21*a35*a44*a52+a11*a23*a35*a44*a52+       &
        a14*a23*a31*a45*a52-a13*a24*a31*a45*a52-a14*a21*a33*a45*a52+       &
        a11*a24*a33*a45*a52+a13*a21*a34*a45*a52-a11*a23*a34*a45*a52+       &
        a15*a24*a32*a41*a53-a14*a25*a32*a41*a53-a15*a22*a34*a41*a53+       &
        a12*a25*a34*a41*a53+a14*a22*a35*a41*a53-a12*a24*a35*a41*a53-       &
        a15*a24*a31*a42*a53+a14*a25*a31*a42*a53+a15*a21*a34*a42*a53-       &
        a11*a25*a34*a42*a53-a14*a21*a35*a42*a53+a11*a24*a35*a42*a53+       &
        a15*a22*a31*a44*a53-a12*a25*a31*a44*a53-a15*a21*a32*a44*a53+       &
        a11*a25*a32*a44*a53+a12*a21*a35*a44*a53-a11*a22*a35*a44*a53-       &
        a14*a22*a31*a45*a53+a12*a24*a31*a45*a53+a14*a21*a32*a45*a53-       &
        a11*a24*a32*a45*a53-a12*a21*a34*a45*a53+a11*a22*a34*a45*a53-       &
        a15*a23*a32*a41*a54+a13*a25*a32*a41*a54+a15*a22*a33*a41*a54-       &
        a12*a25*a33*a41*a54-a13*a22*a35*a41*a54+a12*a23*a35*a41*a54+       &
        a15*a23*a31*a42*a54-a13*a25*a31*a42*a54-a15*a21*a33*a42*a54+       &
        a11*a25*a33*a42*a54+a13*a21*a35*a42*a54-a11*a23*a35*a42*a54-       &
        a15*a22*a31*a43*a54+a12*a25*a31*a43*a54+a15*a21*a32*a43*a54-       &
        a11*a25*a32*a43*a54-a12*a21*a35*a43*a54+a11*a22*a35*a43*a54+       &
        a13*a22*a31*a45*a54-a12*a23*a31*a45*a54-a13*a21*a32*a45*a54+       &
        a11*a23*a32*a45*a54+a12*a21*a33*a45*a54-a11*a22*a33*a45*a54+       &
        a14*a23*a32*a41*a55-a13*a24*a32*a41*a55-a14*a22*a33*a41*a55+       &
        a12*a24*a33*a41*a55+a13*a22*a34*a41*a55-a12*a23*a34*a41*a55-       &
        a14*a23*a31*a42*a55+a13*a24*a31*a42*a55+a14*a21*a33*a42*a55-       &
        a11*a24*a33*a42*a55-a13*a21*a34*a42*a55+a11*a23*a34*a42*a55+       &
        a14*a22*a31*a43*a55-a12*a24*a31*a43*a55-a14*a21*a32*a43*a55+       &
        a11*a24*a32*a43*a55+a12*a21*a34*a43*a55-a11*a22*a34*a43*a55-       &
        a13*a22*a31*a44*a55+a12*a23*a31*a44*a55+a13*a21*a32*a44*a55-       &
        a11*a23*a32*a44*a55-a12*a21*a33*a44*a55+a11*a22*a33*a44*a55

    !if( abs(det) .le. eps)then
    if( abs(det) .eq. 0.0d0 )then
     ainv = 0.0d0
     flag = 0
     return
    endif

    cofactor(1,1) = a25*a34*a43*a52-a24*a35*a43*a52-a25*a33*a44*a52+      &
        a23*a35*a44*a52+a24*a33*a45*a52-a23*a34*a45*a52-a25*a34*a42*a53+   &
        a24*a35*a42*a53+a25*a32*a44*a53-a22*a35*a44*a53-a24*a32*a45*a53+   &
        a22*a34*a45*a53+a25*a33*a42*a54-a23*a35*a42*a54-a25*a32*a43*a54+   &
        a22*a35*a43*a54+a23*a32*a45*a54-a22*a33*a45*a54-a24*a33*a42*a55+   &
        a23*a34*a42*a55+a24*a32*a43*a55-a22*a34*a43*a55-a23*a32*a44*a55+   &
        a22*a33*a44*a55

    cofactor(2,1) = -a15*a34*a43*a52+a14*a35*a43*a52+a15*a33*a44*a52-     &
        a13*a35*a44*a52-a14*a33*a45*a52+a13*a34*a45*a52+a15*a34*a42*a53-   &
        a14*a35*a42*a53-a15*a32*a44*a53+a12*a35*a44*a53+a14*a32*a45*a53-   &
        a12*a34*a45*a53-a15*a33*a42*a54+a13*a35*a42*a54+a15*a32*a43*a54-   &
        a12*a35*a43*a54-a13*a32*a45*a54+a12*a33*a45*a54+a14*a33*a42*a55-   &
        a13*a34*a42*a55-a14*a32*a43*a55+a12*a34*a43*a55+a13*a32*a44*a55-   &
        a12*a33*a44*a55

    cofactor(3,1) = a15*a24*a43*a52-a14*a25*a43*a52-a15*a23*a44*a52+      &
        a13*a25*a44*a52+a14*a23*a45*a52-a13*a24*a45*a52-a15*a24*a42*a53+   &
        a14*a25*a42*a53+a15*a22*a44*a53-a12*a25*a44*a53-a14*a22*a45*a53+   &
        a12*a24*a45*a53+a15*a23*a42*a54-a13*a25*a42*a54-a15*a22*a43*a54+   &
        a12*a25*a43*a54+a13*a22*a45*a54-a12*a23*a45*a54-a14*a23*a42*a55+   &
        a13*a24*a42*a55+a14*a22*a43*a55-a12*a24*a43*a55-a13*a22*a44*a55+   &
        a12*a23*a44*a55

    cofactor(4,1) = -a15*a24*a33*a52+a14*a25*a33*a52+a15*a23*a34*a52-     &
        a13*a25*a34*a52-a14*a23*a35*a52+a13*a24*a35*a52+a15*a24*a32*a53-   &
        a14*a25*a32*a53-a15*a22*a34*a53+a12*a25*a34*a53+a14*a22*a35*a53-   &
        a12*a24*a35*a53-a15*a23*a32*a54+a13*a25*a32*a54+a15*a22*a33*a54-   &
        a12*a25*a33*a54-a13*a22*a35*a54+a12*a23*a35*a54+a14*a23*a32*a55-   &
        a13*a24*a32*a55-a14*a22*a33*a55+a12*a24*a33*a55+a13*a22*a34*a55-   &
        a12*a23*a34*a55

    cofactor(5,1) = a15*a24*a33*a42-a14*a25*a33*a42-a15*a23*a34*a42+      &
        a13*a25*a34*a42+a14*a23*a35*a42-a13*a24*a35*a42-a15*a24*a32*a43+   &
        a14*a25*a32*a43+a15*a22*a34*a43-a12*a25*a34*a43-a14*a22*a35*a43+   &
        a12*a24*a35*a43+a15*a23*a32*a44-a13*a25*a32*a44-a15*a22*a33*a44+   &
        a12*a25*a33*a44+a13*a22*a35*a44-a12*a23*a35*a44-a14*a23*a32*a45+   &
        a13*a24*a32*a45+a14*a22*a33*a45-a12*a24*a33*a45-a13*a22*a34*a45+   &
        a12*a23*a34*a45

    cofactor(1,2) = -a25*a34*a43*a51+a24*a35*a43*a51+a25*a33*a44*a51-     &
        a23*a35*a44*a51-a24*a33*a45*a51+a23*a34*a45*a51+a25*a34*a41*a53-   &
        a24*a35*a41*a53-a25*a31*a44*a53+a21*a35*a44*a53+a24*a31*a45*a53-   &
        a21*a34*a45*a53-a25*a33*a41*a54+a23*a35*a41*a54+a25*a31*a43*a54-   &
        a21*a35*a43*a54-a23*a31*a45*a54+a21*a33*a45*a54+a24*a33*a41*a55-   &
        a23*a34*a41*a55-a24*a31*a43*a55+a21*a34*a43*a55+a23*a31*a44*a55-   &
        a21*a33*a44*a55

    cofactor(2,2) = a15*a34*a43*a51-a14*a35*a43*a51-a15*a33*a44*a51+      &
        a13*a35*a44*a51+a14*a33*a45*a51-a13*a34*a45*a51-a15*a34*a41*a53+   &
        a14*a35*a41*a53+a15*a31*a44*a53-a11*a35*a44*a53-a14*a31*a45*a53+   &
        a11*a34*a45*a53+a15*a33*a41*a54-a13*a35*a41*a54-a15*a31*a43*a54+   &
        a11*a35*a43*a54+a13*a31*a45*a54-a11*a33*a45*a54-a14*a33*a41*a55+   &
        a13*a34*a41*a55+a14*a31*a43*a55-a11*a34*a43*a55-a13*a31*a44*a55+   &
        a11*a33*a44*a55

    cofactor(3,2) = -a15*a24*a43*a51+a14*a25*a43*a51+a15*a23*a44*a51-     &
        a13*a25*a44*a51-a14*a23*a45*a51+a13*a24*a45*a51+a15*a24*a41*a53-   &
        a14*a25*a41*a53-a15*a21*a44*a53+a11*a25*a44*a53+a14*a21*a45*a53-   &
        a11*a24*a45*a53-a15*a23*a41*a54+a13*a25*a41*a54+a15*a21*a43*a54-   &
        a11*a25*a43*a54-a13*a21*a45*a54+a11*a23*a45*a54+a14*a23*a41*a55-   &
        a13*a24*a41*a55-a14*a21*a43*a55+a11*a24*a43*a55+a13*a21*a44*a55-   &
        a11*a23*a44*a55

    cofactor(4,2) = a15*a24*a33*a51-a14*a25*a33*a51-a15*a23*a34*a51+      &
        a13*a25*a34*a51+a14*a23*a35*a51-a13*a24*a35*a51-a15*a24*a31*a53+   &
        a14*a25*a31*a53+a15*a21*a34*a53-a11*a25*a34*a53-a14*a21*a35*a53+   &
        a11*a24*a35*a53+a15*a23*a31*a54-a13*a25*a31*a54-a15*a21*a33*a54+   &
        a11*a25*a33*a54+a13*a21*a35*a54-a11*a23*a35*a54-a14*a23*a31*a55+   &
        a13*a24*a31*a55+a14*a21*a33*a55-a11*a24*a33*a55-a13*a21*a34*a55+   &
        a11*a23*a34*a55

    cofactor(5,2) = -a15*a24*a33*a41+a14*a25*a33*a41+a15*a23*a34*a41-     &
        a13*a25*a34*a41-a14*a23*a35*a41+a13*a24*a35*a41+a15*a24*a31*a43-   &
        a14*a25*a31*a43-a15*a21*a34*a43+a11*a25*a34*a43+a14*a21*a35*a43-   &
        a11*a24*a35*a43-a15*a23*a31*a44+a13*a25*a31*a44+a15*a21*a33*a44-   &
        a11*a25*a33*a44-a13*a21*a35*a44+a11*a23*a35*a44+a14*a23*a31*a45-   &
        a13*a24*a31*a45-a14*a21*a33*a45+a11*a24*a33*a45+a13*a21*a34*a45-   &
        a11*a23*a34*a45

    cofactor(1,3) = a25*a34*a42*a51-a24*a35*a42*a51-a25*a32*a44*a51+      &
        a22*a35*a44*a51+a24*a32*a45*a51-a22*a34*a45*a51-a25*a34*a41*a52+   &
        a24*a35*a41*a52+a25*a31*a44*a52-a21*a35*a44*a52-a24*a31*a45*a52+   &
        a21*a34*a45*a52+a25*a32*a41*a54-a22*a35*a41*a54-a25*a31*a42*a54+   &
        a21*a35*a42*a54+a22*a31*a45*a54-a21*a32*a45*a54-a24*a32*a41*a55+   &
        a22*a34*a41*a55+a24*a31*a42*a55-a21*a34*a42*a55-a22*a31*a44*a55+   &
        a21*a32*a44*a55

    cofactor(2,3) = -a15*a34*a42*a51+a14*a35*a42*a51+a15*a32*a44*a51-     &
        a12*a35*a44*a51-a14*a32*a45*a51+a12*a34*a45*a51+a15*a34*a41*a52-   &
        a14*a35*a41*a52-a15*a31*a44*a52+a11*a35*a44*a52+a14*a31*a45*a52-   &
        a11*a34*a45*a52-a15*a32*a41*a54+a12*a35*a41*a54+a15*a31*a42*a54-   &
        a11*a35*a42*a54-a12*a31*a45*a54+a11*a32*a45*a54+a14*a32*a41*a55-   &
        a12*a34*a41*a55-a14*a31*a42*a55+a11*a34*a42*a55+a12*a31*a44*a55-   &
        a11*a32*a44*a55

    cofactor(3,3) = a15*a24*a42*a51-a14*a25*a42*a51-a15*a22*a44*a51+      &
        a12*a25*a44*a51+a14*a22*a45*a51-a12*a24*a45*a51-a15*a24*a41*a52+   &
        a14*a25*a41*a52+a15*a21*a44*a52-a11*a25*a44*a52-a14*a21*a45*a52+   &
        a11*a24*a45*a52+a15*a22*a41*a54-a12*a25*a41*a54-a15*a21*a42*a54+   &
        a11*a25*a42*a54+a12*a21*a45*a54-a11*a22*a45*a54-a14*a22*a41*a55+   &
        a12*a24*a41*a55+a14*a21*a42*a55-a11*a24*a42*a55-a12*a21*a44*a55+   &
        a11*a22*a44*a55

    cofactor(4,3) = -a15*a24*a32*a51+a14*a25*a32*a51+a15*a22*a34*a51-     &
        a12*a25*a34*a51-a14*a22*a35*a51+a12*a24*a35*a51+a15*a24*a31*a52-   &
        a14*a25*a31*a52-a15*a21*a34*a52+a11*a25*a34*a52+a14*a21*a35*a52-   &
        a11*a24*a35*a52-a15*a22*a31*a54+a12*a25*a31*a54+a15*a21*a32*a54-   &
        a11*a25*a32*a54-a12*a21*a35*a54+a11*a22*a35*a54+a14*a22*a31*a55-   &
        a12*a24*a31*a55-a14*a21*a32*a55+a11*a24*a32*a55+a12*a21*a34*a55-   &
        a11*a22*a34*a55

    cofactor(5,3) = a15*a24*a32*a41-a14*a25*a32*a41-a15*a22*a34*a41+      &
        a12*a25*a34*a41+a14*a22*a35*a41-a12*a24*a35*a41-a15*a24*a31*a42+   &
        a14*a25*a31*a42+a15*a21*a34*a42-a11*a25*a34*a42-a14*a21*a35*a42+   &
        a11*a24*a35*a42+a15*a22*a31*a44-a12*a25*a31*a44-a15*a21*a32*a44+   &
        a11*a25*a32*a44+a12*a21*a35*a44-a11*a22*a35*a44-a14*a22*a31*a45+   &
        a12*a24*a31*a45+a14*a21*a32*a45-a11*a24*a32*a45-a12*a21*a34*a45+   &
        a11*a22*a34*a45

    cofactor(1,4) = -a25*a33*a42*a51+a23*a35*a42*a51+a25*a32*a43*a51-     &
        a22*a35*a43*a51-a23*a32*a45*a51+a22*a33*a45*a51+a25*a33*a41*a52-   &
        a23*a35*a41*a52-a25*a31*a43*a52+a21*a35*a43*a52+a23*a31*a45*a52-   &
        a21*a33*a45*a52-a25*a32*a41*a53+a22*a35*a41*a53+a25*a31*a42*a53-   &
        a21*a35*a42*a53-a22*a31*a45*a53+a21*a32*a45*a53+a23*a32*a41*a55-   &
        a22*a33*a41*a55-a23*a31*a42*a55+a21*a33*a42*a55+a22*a31*a43*a55-   &
        a21*a32*a43*a55

    cofactor(2,4) = a15*a33*a42*a51-a13*a35*a42*a51-a15*a32*a43*a51+      &
        a12*a35*a43*a51+a13*a32*a45*a51-a12*a33*a45*a51-a15*a33*a41*a52+   &
        a13*a35*a41*a52+a15*a31*a43*a52-a11*a35*a43*a52-a13*a31*a45*a52+   &
        a11*a33*a45*a52+a15*a32*a41*a53-a12*a35*a41*a53-a15*a31*a42*a53+   &
        a11*a35*a42*a53+a12*a31*a45*a53-a11*a32*a45*a53-a13*a32*a41*a55+   &
        a12*a33*a41*a55+a13*a31*a42*a55-a11*a33*a42*a55-a12*a31*a43*a55+   &
        a11*a32*a43*a55

    cofactor(3,4) = -a15*a23*a42*a51+a13*a25*a42*a51+a15*a22*a43*a51-     &
        a12*a25*a43*a51-a13*a22*a45*a51+a12*a23*a45*a51+a15*a23*a41*a52-   &
        a13*a25*a41*a52-a15*a21*a43*a52+a11*a25*a43*a52+a13*a21*a45*a52-   &
        a11*a23*a45*a52-a15*a22*a41*a53+a12*a25*a41*a53+a15*a21*a42*a53-   &
        a11*a25*a42*a53-a12*a21*a45*a53+a11*a22*a45*a53+a13*a22*a41*a55-   &
        a12*a23*a41*a55-a13*a21*a42*a55+a11*a23*a42*a55+a12*a21*a43*a55-   &
        a11*a22*a43*a55

    cofactor(4,4) = a15*a23*a32*a51-a13*a25*a32*a51-a15*a22*a33*a51+      &
        a12*a25*a33*a51+a13*a22*a35*a51-a12*a23*a35*a51-a15*a23*a31*a52+   &
        a13*a25*a31*a52+a15*a21*a33*a52-a11*a25*a33*a52-a13*a21*a35*a52+   &
        a11*a23*a35*a52+a15*a22*a31*a53-a12*a25*a31*a53-a15*a21*a32*a53+   &
        a11*a25*a32*a53+a12*a21*a35*a53-a11*a22*a35*a53-a13*a22*a31*a55+   &
        a12*a23*a31*a55+a13*a21*a32*a55-a11*a23*a32*a55-a12*a21*a33*a55+   &
        a11*a22*a33*a55

    cofactor(5,4) = -a15*a23*a32*a41+a13*a25*a32*a41+a15*a22*a33*a41-     &
        a12*a25*a33*a41-a13*a22*a35*a41+a12*a23*a35*a41+a15*a23*a31*a42-   &
        a13*a25*a31*a42-a15*a21*a33*a42+a11*a25*a33*a42+a13*a21*a35*a42-   &
        a11*a23*a35*a42-a15*a22*a31*a43+a12*a25*a31*a43+a15*a21*a32*a43-   &
        a11*a25*a32*a43-a12*a21*a35*a43+a11*a22*a35*a43+a13*a22*a31*a45-   &
        a12*a23*a31*a45-a13*a21*a32*a45+a11*a23*a32*a45+a12*a21*a33*a45-   &
        a11*a22*a33*a45

    cofactor(1,5) = a24*a33*a42*a51-a23*a34*a42*a51-a24*a32*a43*a51+      &
        a22*a34*a43*a51+a23*a32*a44*a51-a22*a33*a44*a51-a24*a33*a41*a52+   &
        a23*a34*a41*a52+a24*a31*a43*a52-a21*a34*a43*a52-a23*a31*a44*a52+   &
        a21*a33*a44*a52+a24*a32*a41*a53-a22*a34*a41*a53-a24*a31*a42*a53+   &
        a21*a34*a42*a53+a22*a31*a44*a53-a21*a32*a44*a53-a23*a32*a41*a54+   &
        a22*a33*a41*a54+a23*a31*a42*a54-a21*a33*a42*a54-a22*a31*a43*a54+   &
        a21*a32*a43*a54

    cofactor(2,5) = -a14*a33*a42*a51+a13*a34*a42*a51+a14*a32*a43*a51-     &
        a12*a34*a43*a51-a13*a32*a44*a51+a12*a33*a44*a51+a14*a33*a41*a52-   &
        a13*a34*a41*a52-a14*a31*a43*a52+a11*a34*a43*a52+a13*a31*a44*a52-   &
        a11*a33*a44*a52-a14*a32*a41*a53+a12*a34*a41*a53+a14*a31*a42*a53-   &
        a11*a34*a42*a53-a12*a31*a44*a53+a11*a32*a44*a53+a13*a32*a41*a54-   &
        a12*a33*a41*a54-a13*a31*a42*a54+a11*a33*a42*a54+a12*a31*a43*a54-   &
        a11*a32*a43*a54

    cofactor(3,5) = a14*a23*a42*a51-a13*a24*a42*a51-a14*a22*a43*a51+      &
        a12*a24*a43*a51+a13*a22*a44*a51-a12*a23*a44*a51-a14*a23*a41*a52+   &
        a13*a24*a41*a52+a14*a21*a43*a52-a11*a24*a43*a52-a13*a21*a44*a52+   &
        a11*a23*a44*a52+a14*a22*a41*a53-a12*a24*a41*a53-a14*a21*a42*a53+   &
        a11*a24*a42*a53+a12*a21*a44*a53-a11*a22*a44*a53-a13*a22*a41*a54+   &
        a12*a23*a41*a54+a13*a21*a42*a54-a11*a23*a42*a54-a12*a21*a43*a54+   &
        a11*a22*a43*a54

    cofactor(4,5) = -a14*a23*a32*a51+a13*a24*a32*a51+a14*a22*a33*a51-     &
        a12*a24*a33*a51-a13*a22*a34*a51+a12*a23*a34*a51+a14*a23*a31*a52-   &
        a13*a24*a31*a52-a14*a21*a33*a52+a11*a24*a33*a52+a13*a21*a34*a52-   &
        a11*a23*a34*a52-a14*a22*a31*a53+a12*a24*a31*a53+a14*a21*a32*a53-   &
        a11*a24*a32*a53-a12*a21*a34*a53+a11*a22*a34*a53+a13*a22*a31*a54-   &
        a12*a23*a31*a54-a13*a21*a32*a54+a11*a23*a32*a54+a12*a21*a33*a54-   &
        a11*a22*a33*a54

    cofactor(5,5) = a14*a23*a32*a41-a13*a24*a32*a41-a14*a22*a33*a41+      &
        a12*a24*a33*a41+a13*a22*a34*a41-a12*a23*a34*a41-a14*a23*a31*a42+   &
        a13*a24*a31*a42+a14*a21*a33*a42-a11*a24*a33*a42-a13*a21*a34*a42+   &
        a11*a23*a34*a42+a14*a22*a31*a43-a12*a24*a31*a43-a14*a21*a32*a43+   &
        a11*a24*a32*a43+a12*a21*a34*a43-a11*a22*a34*a43-a13*a22*a31*a44+   &
        a12*a23*a31*a44+a13*a21*a32*a44-a11*a23*a32*a44-a12*a21*a33*a44+   &
        a11*a22*a33*a44

    ainv = transpose(cofactor)/det
    flag = 1

    return
    end subroutine m55inv

